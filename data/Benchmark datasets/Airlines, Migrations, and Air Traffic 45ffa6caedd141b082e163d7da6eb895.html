<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>airlines-migrations-and-air-traffic-45ffa6caedd141b082e163d7da6eb895 – GD benchmark sets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a202ed359b7240dcab911ed64cbd0efc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#airlines-migrations-and-air-traffic" id="toc-airlines-migrations-and-air-traffic" class="nav-link active" data-scroll-target="#airlines-migrations-and-air-traffic"><span class="header-section-number">1</span> Airlines, Migrations, and Air Traffic</a></li>
  <li><a href="#body" id="toc-body" class="nav-link" data-scroll-target="#body"><span class="header-section-number">2</span> Body</a>
  <ul class="collapse">
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics">Statistics</a></li>
  <li><a href="#descriptions-from-literature" id="toc-descriptions-from-literature" class="nav-link" data-scroll-target="#descriptions-from-literature">Descriptions from Literature</a></li>
  <li><a href="#example-figures" id="toc-example-figures" class="nav-link" data-scroll-target="#example-figures">Example Figures</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="airlines-migrations-and-air-traffic" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Airlines, Migrations, and Air Traffic</h1>
<p>Origin Notes: Data collected from the Edge-Path bundling paper by Markus Wallinger et al.&nbsp;They cite the Airlines dataset to Force Directed Edge Bundling for Graph Visualization and the migrations dataset to Geometry-Based Edge Clustering for Graph Visualization. graph features handled: Bundled edges (generated), Directed edges, Generic, Spatial Graph features in papers: generic,spatial,spatial,clusters (generated),dynamic,spatial,bundled edges (generated),generic,bundled edges (generated),spatial,dynamic,dynamic (discrete),bundled edges (generated),directed edges,spatial Origin Paper: Force-Directed Edge Bundling for Graph Visualization (https://www.notion.so/Force-Directed-Edge-Bundling-for-Graph-Visualization-597d0c38c51e433090a7706cdc9bd6a3?pvs=21), Geometry-Based Edge Clustering for Graph Visualization (https://www.notion.so/Geometry-Based-Edge-Clustering-for-Graph-Visualization-72e7c5d193e34645a3cbca78df6fd1c8?pvs=21), Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach (https://www.notion.so/Edge-Path-Bundling-A-Less-Ambiguous-Edge-Bundling-Approach-be7daf7cd0ce4a73b1ad00bb25af472c?pvs=21) Originally found at: https://github.com/mwallinger-tu/edge-path-bundling/tree/master/data Size: 235-1702 nodes, 2101-16494 edges Number of Graphs: 3 format: JSON file but with spcific attributes for their tool so needs to be parsed Appeared in years: 2011,2009,2016,2008,2017,2020,2022,2023 Type of Collection: Aggregate collection is it stored properly?: No must be analyzed: No In repo?: Yes Related to Literature - Algorithm (1) (Dataset tag relations): Force-directed edge bundling for graph visualization (https://www.notion.so/Force-directed-edge-bundling-for-graph-visualization-09ec16bfe40d4fbea880bfc4e640bbfa?pvs=21), MLSEB: Edge Bundling Using Moving Least Squares Approximation (https://www.notion.so/MLSEB-Edge-Bundling-Using-Moving-Least-Squares-Approximation-474c60d6caff41a3a09b5ba2f1f513d8?pvs=21), HOTVis: Higher-Order Time-Aware Visualisation of Dynamic Graphs (https://www.notion.so/HOTVis-Higher-Order-Time-Aware-Visualisation-of-Dynamic-Graphs-4ce353bf13094484988b5f8bb306c8d8?pvs=21), MobilityGraphs: Visual Analysis of Mass Mobility Dynamics via Spatio-Temporal Graphs and Clustering (https://www.notion.so/MobilityGraphs-Visual-Analysis-of-Mass-Mobility-Dynamics-via-Spatio-Temporal-Graphs-and-Clustering-69e89e0d31134f8997cdaaa266e4ba9c?pvs=21), Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach (https://www.notion.so/Edge-Path-Bundling-A-Less-Ambiguous-Edge-Bundling-Approach-932f56be1ec24c50a2c3fc65a37ed172?pvs=21), Geometry-Based Edge Clustering for Graph Visualization (https://www.notion.so/Geometry-Based-Edge-Clustering-for-Graph-Visualization-c3e8767d7784426f815b386900c6cee9?pvs=21), Skeleton-Based Edge Bundling for Graph Visualization (https://www.notion.so/Skeleton-Based-Edge-Bundling-for-Graph-Visualization-f62005dde2124553a06f4f0883976ca9?pvs=21) cleaned format?: Yes duplicate?: No link works?: Yes Added in paper: No OSF link json: https://files.osf.io/v1/resources/j7ucv/providers/osfstorage/64d90e774cf7480ef0055631 Origin paper plaintext: Force-Directed Edge Bundling for Graph Visualization, Geometry-Based Edge Clustering for Graph Visualization, Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach Page id: 45ffa6caedd141b082e163d7da6eb895 unavailable/skip: No Cleaned ALL data: No OSF link gexf: https://files.osf.io/v1/resources/j7ucv/providers/osfstorage/64d9490a1101aa0dcf6a0ba5 OSF link gml: https://files.osf.io/v1/resources/j7ucv/providers/osfstorage/64d96d8c0c2b4d0f64386243 OSF link graphml: https://files.osf.io/v1/resources/j7ucv/providers/osfstorage/64d971241101aa0e9f6a0c0b first look: No sparkline data: {‘min’: 235, ‘max’: 1702, ‘step_size’: 1500, ‘num_bins’: 2, ‘bins’: [0, 1500], ‘num_nodes’: [1, 2]} Related to Literature - Algorithm (Dataset tag relations) 1: Skeleton-Based Edge Bundling for Graph Visualization (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Skeleton-Based%20Edge%20Bundling%20for%20Graph%20Visualizati%206dd78ad2473945c99d670dea9546af1c.md), Force-directed edge bundling for graph visualization (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Force-directed%20edge%20bundling%20for%20graph%20visualizati%201a6dc388a0f4443ca2d3693f8bff3f74.md), MobilityGraphs: Visual Analysis of Mass Mobility Dynamics via Spatio-Temporal Graphs and Clustering (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/MobilityGraphs%20Visual%20Analysis%20of%20Mass%20Mobility%20Dy%2003cbcaf73d9b4c0784e8e44b38185eb6.md), Geometry-Based Edge Clustering for Graph Visualization (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Geometry-Based%20Edge%20Clustering%20for%20Graph%20Visualiza%204266d74d6ae1420a970d2b1a74a38fc7.md), MLSEB: Edge Bundling Using Moving Least Squares Approximation (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/MLSEB%20Edge%20Bundling%20Using%20Moving%20Least%20Squares%20App%20bf3edb74a4cd4476838fdcc3d531f9b5.md), HOTVis: Higher-Order Time-Aware Visualisation of Dynamic Graphs (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/HOTVis%20Higher-Order%20Time-Aware%20Visualisation%20of%20Dy%20bd698d90a24a4b8e9527007489d139b5.md), Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Edge-Path%20Bundling%20A%20Less%20Ambiguous%20Edge%20Bundling%20%20fcfa5882e692481298cbee906e005c30.md), Interactive Structure-aware Blending of Diverse Edge Bundling Visualizations (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Interactive%20Structure-aware%20Blending%20of%20Diverse%20Ed%204fbfba72a5b046f8baf7211508790373.md), Faster Edge-Path Bundling through Graph Spanners (../Benchmark%20sets%200cc6b5e454304aec98f3b59b1a720476/Literature%20ad87f14e7097454fb2f784e2c8a2797a/Literature%20-%20Algorithm%2012e01bfc60a84007aa7d2d34293e123d/Faster%20Edge-Path%20Bundling%20through%20Graph%20Spanners%2064dc9f75adc942ffb7dd7259a8357cf8.md)</p>
</section>
<section id="body" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Body</h1>
<section id="statistics" class="level3">
<h3 class="anchored" data-anchor-id="statistics">Statistics</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Airlines, Migrations, and Air Traffic 45ffa6caedd141b082e163d7da6eb895/four_in_one.svg" class="img-fluid figure-img"></p>
<figcaption>four_in_one.svg</figcaption>
</figure>
</div>
</section>
<section id="descriptions-from-literature" class="level3">
<h3 class="anchored" data-anchor-id="descriptions-from-literature">Descriptions from Literature</h3>
<p>From “<a href="https://doi.org/10.1109/TVCG.2011.233">Skeleton-Based Edge Bundling for Graph Visualization</a>”:</p>
<blockquote class="blockquote">
<p>Figure 7 illustrates the SBEB and compares it with several existing bundling methods. Note that in all images here generated with our method, we used simple additive edge blending only, as our focus here is the layout, not the rendering. Images (a,b) show an air traffic graph (nodes are city locations, edges are interconnecting flights)… Images (e-h) show the US migrations graph bundled with the WR, GBEB, FDEB, and our method (SBEB) respectively. Overall, SBEB produces stronger bundling, due to the many iterations I = 10 being used), and emphasizes the structure of connections between groups of close cities (due to the skeleton layout cues). If less bundling is desired, fewer iterations can be used (Fig. 4). Adjusting the postprocessing smoothing and relaxation parameters, SBEB can create bundling styles similar to either GBEB (higher bundle curvatures, more emphasis on the graph structure) or FDEB (smoother bundles). Finally, images (i,j) show the US airlines graph bundled with the FDEB and SBEB respectively. SBEB generates stronger bundling (more overdraw) but arguably less clutter. Note also that SBEB generates treelike bundle structures which is useful when the exploration task at hand has an inherent (local) hierarchical nature, e.g.&nbsp;see how traffic connections merge into and/or split from main traffic routes.</p>
</blockquote>
</section>
<section id="example-figures" class="level3">
<h3 class="anchored" data-anchor-id="example-figures">Example Figures</h3>
<p>From “<a href="https://ieeexplore.ieee.org/document/9552919">Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach</a>”:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Airlines, Migrations, and Air Traffic 45ffa6caedd141b082e163d7da6eb895/Untitled.png" class="img-fluid figure-img"></p>
<figcaption>Untitled</figcaption>
</figure>
</div>
<p><strong>Fig. 1.</strong> Edge bundling of the migrations dataset. (a) Straight line drawing. (b) Force-directed edge bundling aggregates edges well, but overaggregates at the centre of the drawing making it difficult to see patterns in the east-west flow (red bundle). (c) Cubu has a similar drawback at the centre of the map to a lesser degree. (d) Winding roads divides this structure into several smaller flows, but they may not be necessarily related to graph structure. (e) Edge-path bundling is able to distinguish between several flows that reflect paths in the underlying graph. (f) When edge direction is considered, the algorithm is able to further subdivide these flows based on direction.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Airlines, Migrations, and Air Traffic 45ffa6caedd141b082e163d7da6eb895/Untitled 1.png" class="img-fluid figure-img"></p>
<figcaption>Untitled</figcaption>
</figure>
</div>
<p><strong>Fig. 8.</strong> Airlines (undirected). (a) Input drawing. (b) Force-directed bundling is able to cluster edges into the major flows, but some overaggregation prevents details from being visualised. (c) Cubu provides a good bundling, but also has overaggregation. (c) Confluent drawings can be imposed on the layout, but as the approach cannot layout the graph bicliques can be distantly located, resulting in suboptimal performance. (e) Winding roads divides the flows into many streams, but these streams can be unfaithful to graph structure. (f) Edge-path bundling aggregates edges using weighted paths. The four prominent bundle intersections on the east coast correspond to major airports: Atlanta, Detroit, Minneapolis, and Dallas.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Airlines, Migrations, and Air Traffic 45ffa6caedd141b082e163d7da6eb895/Untitled 2.png" class="img-fluid figure-img"></p>
<figcaption>Untitled</figcaption>
</figure>
</div>
<p><strong>Fig. 10.</strong> Results of four algorithms on the air traffic network. (a) Force-directed bundling is able to recover the major trajectories but does not strongly bundle the network. (b) Cubu strongly bundles the main flows of airtraffic, but can suffer from overaggregation. (c) Winding roads divides the traffic into many smaller bundles, but this may not be reflective of underlying graph structure. (d) With edge-path bundling, each bundle necessarily reflects a path in the network. There are separate flows across the atlantic and asia that correspond to paths through the network.</p>
<p>From “<a href="https://doi.org/10.1109/TVCG.2011.233">Skeleton-Based Edge Bundling for Graph Visualization</a>”:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Airlines, Migrations, and Air Traffic 45ffa6caedd141b082e163d7da6eb895/Screen_Shot_2023-08-14_at_3.42.37_PM.png" class="img-fluid figure-img"></p>
<figcaption>Screen Shot 2023-08-14 at 3.42.37 PM.png</figcaption>
</figure>
</div>
<p>== STOP RENDERING ==</p>
<p>gd contest: <a href="http://www.research.att.com/conf/gd96/contest.html">http://www.research.att.com/conf/gd96/contest.html</a></p>
<p>look here: <a href="https://github.com/mwallinger-tu/edge-path-bundling/tree/master/data">https://github.com/mwallinger-tu/edge-path-bundling/tree/master/data</a> from <a href="../Benchmark sets 0cc6b5e454304aec98f3b59b1a720476/Literature ad87f14e7097454fb2f784e2c8a2797a/Literature - Algorithm 12e01bfc60a84007aa7d2d34293e123d/Edge-Path Bundling A Less Ambiguous Edge Bundling  fcfa5882e692481298cbee906e005c30.md"><strong>Edge-Path Bundling: A Less Ambiguous Edge Bundling Approach</strong></a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
});
</script>
</div> <!-- /content -->




</body></html>